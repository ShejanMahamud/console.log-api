<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>consolelog documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">consolelog documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">








<ol class="breadcrumb">
  <li class="breadcrumb-item">Injectables</li>
  <li class="breadcrumb-item" >AuthService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/auth/auth.service.ts</code>
        </p>





            <section data-compodoc="block-index">
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#accessTokenExpiresIn" >accessTokenExpiresIn</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#accessTokenSecret" >accessTokenSecret</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#refreshTokenExpiresIn" >refreshTokenExpiresIn</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Readonly</span>
                                <a href="#refreshTokenSecret" >refreshTokenSecret</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#changePassword" >changePassword</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#forgetPassword" >forgetPassword</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#generateTokens" >generateTokens</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#githubLogin" >githubLogin</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#googleLogin" >googleLogin</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#isExpired" >isExpired</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#isMatched" >isMatched</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#isUserExists" >isUserExists</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#loginUser" >loginUser</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#logOut" >logOut</a>
                            </li>
                            <li>
                                    <span class="modifier">Async</span>
                                <a href="#refreshToken" >refreshToken</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#registerUser" >registerUser</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#resendAccountVerification" >resendAccountVerification</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#resetPassword" >resetPassword</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                    <span class="modifier">Async</span>
                                <a href="#saveTokenInDb" >saveTokenInDb</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#updateUser" >updateUser</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#validateAccountVerifyEmail" >validateAccountVerifyEmail</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section data-compodoc="block-constructor">
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(prisma: <a href="../injectables/PrismaService.html" target="_self">PrismaService</a>, config: ConfigService, upload: <a href="../injectables/UploadService.html" target="_self">UploadService</a>, jwt: JwtService, mail: <a href="../injectables/MailService.html" target="_self">MailService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="33" class="link-to-prism">src/auth/auth.service.ts:33</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>prisma</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/PrismaService.html" target="_self" >PrismaService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>config</td>
                                                  
                                                        <td>
                                                                    <code>ConfigService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>upload</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/UploadService.html" target="_self" >UploadService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>jwt</td>
                                                  
                                                        <td>
                                                                    <code>JwtService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>mail</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/MailService.html" target="_self" >MailService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section data-compodoc="block-methods">
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="changePassword"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>changePassword</b></span>
                        <a href="#changePassword"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>changePassword(data: <a href="../classes/ChangePasswordDto.html" target="_self">ChangePasswordDto</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="486"
                                    class="link-to-prism">src/auth/auth.service.ts:486</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/ChangePasswordDto.html" target="_self" >ChangePasswordDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="forgetPassword"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>forgetPassword</b></span>
                        <a href="#forgetPassword"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>forgetPassword(data: <a href="../classes/ForgetPasswordDto.html" target="_self">ForgetPasswordDto</a>, req: Request)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="437"
                                    class="link-to-prism">src/auth/auth.service.ts:437</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/ForgetPasswordDto.html" target="_self" >ForgetPasswordDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>req</td>
                                            <td>
                                                        <code>Request</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="generateTokens"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>generateTokens</b></span>
                        <a href="#generateTokens"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>generateTokens(data: <a href="../interfaces/IJwtPayload.html" target="_self">IJwtPayload</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="418"
                                    class="link-to-prism">src/auth/auth.service.ts:418</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../interfaces/IJwtPayload.html" target="_self" >IJwtPayload</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="githubLogin"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>githubLogin</b></span>
                        <a href="#githubLogin"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>githubLogin(data: <a href="../classes/GithubLoginDto.html" target="_self">GithubLoginDto</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="387"
                                    class="link-to-prism">src/auth/auth.service.ts:387</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/GithubLoginDto.html" target="_self" >GithubLoginDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="googleLogin"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>googleLogin</b></span>
                        <a href="#googleLogin"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>googleLogin(data: <a href="../classes/GoogleLoginDto.html" target="_self">GoogleLoginDto</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="356"
                                    class="link-to-prism">src/auth/auth.service.ts:356</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/GoogleLoginDto.html" target="_self" >GoogleLoginDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isExpired"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                        <span ><b>isExpired</b></span>
                        <a href="#isExpired"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>isExpired(date: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank">Date</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="95"
                                    class="link-to-prism">src/auth/auth.service.ts:95</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>date</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date" target="_blank" >Date</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isMatched"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>isMatched</b></span>
                        <a href="#isMatched"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>isMatched(hashed: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, text: string | Buffer)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="100"
                                    class="link-to-prism">src/auth/auth.service.ts:100</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>hashed</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>text</td>
                                            <td>
                                                        <code>string | Buffer</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;boolean&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isUserExists"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>isUserExists</b></span>
                        <a href="#isUserExists"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>isUserExists(identifiers: literal type)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="70"
                                    class="link-to-prism">src/auth/auth.service.ts:70</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>identifiers</td>
                                            <td>
                                                        <code>literal type</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>Promise&lt;boolean&gt;</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="loginUser"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>loginUser</b></span>
                        <a href="#loginUser"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>loginUser(data: <a href="../classes/LoginDto.html" target="_self">LoginDto</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="318"
                                    class="link-to-prism">src/auth/auth.service.ts:318</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/LoginDto.html" target="_self" >LoginDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="logOut"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>logOut</b></span>
                        <a href="#logOut"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>logOut(data: <a href="../classes/LogoutDto.html" target="_self">LogoutDto</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="587"
                                    class="link-to-prism">src/auth/auth.service.ts:587</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/LogoutDto.html" target="_self" >LogoutDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="refreshToken"></a>
                    <span class="name">
                            <span class="modifier">Async</span>
                        <span ><b>refreshToken</b></span>
                        <a href="#refreshToken"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>refreshToken(data: <a href="../classes/RefreshTokenDto.html" target="_self">RefreshTokenDto</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="199"
                                    class="link-to-prism">src/auth/auth.service.ts:199</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/RefreshTokenDto.html" target="_self" >RefreshTokenDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="registerUser"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>registerUser</b></span>
                        <a href="#registerUser"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>registerUser(data: <a href="../classes/RegisterUserDto.html" target="_self">RegisterUserDto</a>, file: Express.Multer.File, req: Request)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="108"
                                    class="link-to-prism">src/auth/auth.service.ts:108</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/RegisterUserDto.html" target="_self" >RegisterUserDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>file</td>
                                            <td>
                                                        <code>Express.Multer.File</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>req</td>
                                            <td>
                                                        <code>Request</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resendAccountVerification"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>resendAccountVerification</b></span>
                        <a href="#resendAccountVerification"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>resendAccountVerification(email: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, req: Request)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="242"
                                    class="link-to-prism">src/auth/auth.service.ts:242</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>email</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>req</td>
                                            <td>
                                                        <code>Request</code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resetPassword"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>resetPassword</b></span>
                        <a href="#resetPassword"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>resetPassword(data: <a href="../classes/ResetPasswordDto.html" target="_self">ResetPasswordDto</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="520"
                                    class="link-to-prism">src/auth/auth.service.ts:520</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/ResetPasswordDto.html" target="_self" >ResetPasswordDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="saveTokenInDb"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Async</span>
                        <span ><b>saveTokenInDb</b></span>
                        <a href="#saveTokenInDb"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>saveTokenInDb(userId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, email: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, provider?: "email" | "github" | "google")</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="293"
                                    class="link-to-prism">src/auth/auth.service.ts:293</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>userId</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>email</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>provider</td>
                                            <td>
                                                        <code>&quot;email&quot; | &quot;github&quot; | &quot;google&quot;</code>
                                            </td>

                                            <td>
                                                    Yes
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updateUser"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>updateUser</b></span>
                        <a href="#updateUser"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>updateUser(data: <a href="../classes/UpdateUserDto.html" target="_self">Partial&lt;UpdateUserDto&gt;</a>, id: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="562"
                                    class="link-to-prism">src/auth/auth.service.ts:562</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/UpdateUserDto.html" target="_self" >Partial&lt;UpdateUserDto&gt;</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                        <tr>
                                                <td>id</td>
                                            <td>
                                                            <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validateAccountVerifyEmail"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                            <span class="modifier">Async</span>
                        <span ><b>validateAccountVerifyEmail</b></span>
                        <a href="#validateAccountVerifyEmail"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>validateAccountVerifyEmail(data: <a href="../classes/AccountVerifyDto.html" target="_self">AccountVerifyDto</a>)</code>
                </td>
            </tr>


                    <tr>
                        <td class="col-md-4">
                            <div class="io-line">Defined in <a href="" data-line="153"
                                    class="link-to-prism">src/auth/auth.service.ts:153</a></div>
                        </td>
                    </tr>


            <tr>
                <td class="col-md-4">

                            <div class="io-description">
                                <b>Parameters :</b>
                                
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Type</td>
                                            <td>Optional</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                                <td>data</td>
                                            <td>
                                                            <code><a href="../classes/AccountVerifyDto.html" target="_self" >AccountVerifyDto</a></code>
                                            </td>

                                            <td>
                                                    No
                                            </td>


                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        <div class="io-description">
                            <b>Returns : </b>    <code>unknown</code>

                        </div>
                            <div class="io-description">
                                
                            </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section data-compodoc="block-properties">
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="accessTokenExpiresIn"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>accessTokenExpiresIn</b></span>
                        <a href="#accessTokenExpiresIn"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="32" class="link-to-prism">src/auth/auth.service.ts:32</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="accessTokenSecret"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>accessTokenSecret</b></span>
                        <a href="#accessTokenSecret"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="30" class="link-to-prism">src/auth/auth.service.ts:30</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="refreshTokenExpiresIn"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>refreshTokenExpiresIn</b></span>
                        <a href="#refreshTokenExpiresIn"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="33" class="link-to-prism">src/auth/auth.service.ts:33</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="refreshTokenSecret"></a>
                    <span class="name">
                            <span class="modifier">Private</span>
                            <span class="modifier">Readonly</span>
                        <span ><b>refreshTokenSecret</b></span>
                        <a href="#refreshTokenSecret"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="31" class="link-to-prism">src/auth/auth.service.ts:31</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import {
  BadRequestException,
  ForbiddenException,
  Injectable,
  NotFoundException,
  UnauthorizedException,
} from &#x27;@nestjs/common&#x27;;
import { ConfigService } from &#x27;@nestjs/config&#x27;;
import { JwtService } from &#x27;@nestjs/jwt&#x27;;
import { Request } from &#x27;express&#x27;;
import { MailService } from &#x27;src/mail/mail.service&#x27;;
import { PrismaService } from &#x27;src/prisma/prisma.service&#x27;;
import { UploadService } from &#x27;src/upload/upload.service&#x27;;
import { Util } from &#x27;src/utils/util&#x27;;
import { AccountVerifyDto } from &#x27;./dto/account-verify.dto&#x27;;
import { ChangePasswordDto } from &#x27;./dto/change-password.dto&#x27;;
import { RegisterUserDto } from &#x27;./dto/create-user.dto&#x27;;
import { ForgetPasswordDto } from &#x27;./dto/forget-password.dto&#x27;;
import { GithubLoginDto } from &#x27;./dto/github-login.dto&#x27;;
import { GoogleLoginDto } from &#x27;./dto/google-login.dto&#x27;;
import { LoginDto } from &#x27;./dto/login-user.dto&#x27;;
import { LogoutDto } from &#x27;./dto/logout.dto&#x27;;
import { RefreshTokenDto } from &#x27;./dto/refresh-token.dto&#x27;;
import { ResetPasswordDto } from &#x27;./dto/reset-password.dto&#x27;;
import { UpdateUserDto } from &#x27;./dto/update-user.dto&#x27;;
import { IJwtPayload } from &#x27;./types&#x27;;

@Injectable()
export class AuthService {
  private readonly accessTokenSecret: string;
  private readonly refreshTokenSecret: string;
  private readonly accessTokenExpiresIn: string;
  private readonly refreshTokenExpiresIn: string;

  constructor(
    //inject prisma service
    private readonly prisma: PrismaService,

    //inject config service
    private readonly config: ConfigService,

    //inject upload service
    private readonly upload: UploadService,

    //inject jwt service
    private readonly jwt: JwtService,

    //inject mail service
    private readonly mail: MailService,
  ) {
    //access token secret
    this.accessTokenSecret &#x3D; config.get&lt;string&gt;(
      &#x27;ACCESS_TOKEN_SECRET&#x27;,
    ) as string;
    //refresh token secret
    this.refreshTokenSecret &#x3D; config.get&lt;string&gt;(
      &#x27;REFRESH_TOKEN_SECRET&#x27;,
    ) as string;
    //access token expires
    this.accessTokenExpiresIn &#x3D; config.get&lt;string&gt;(
      &#x27;ACCESS_TOKEN_EXPIRES&#x27;,
    ) as string;
    //refresh token expires
    this.refreshTokenExpiresIn &#x3D; config.get&lt;string&gt;(
      &#x27;REFRESH_TOKEN_EXPIRES&#x27;,
    ) as string;
  }

  //check if user exist
  private async isUserExists(identifiers: {
    id?: string;
    email?: string;
    username?: string;
  }): Promise&lt;boolean&gt; {
    const { id, email, username } &#x3D; identifiers;
    if (!id &amp;&amp; !email &amp;&amp; !username) {
      throw new BadRequestException(
        &#x27;At least one of id, email, or username is required.&#x27;,
      );
    }
    const user &#x3D; await this.prisma.user.findFirst({
      where: {
        OR: [
          ...(id ? [{ id }] : []),
          ...(email ? [{ email }] : []),
          ...(username ? [{ username }] : []),
        ],
      },
    });

    return !!user;
  }

  //check is date expire or not
  private isExpired(date: Date) {
    return new Date() &gt; date;
  }

  //check if hashed and text are matched or not
  private async isMatched(
    hashed: string,
    text: string | Buffer,
  ): Promise&lt;boolean&gt; {
    return await Util.match(text, hashed);
  }

  //register a user
  public async registerUser(
    data: RegisterUserDto,
    file: Express.Multer.File,
    req: Request,
  ) {
    //verify token gen
    const verifyToken &#x3D; Util.genToken();
    //gen verify token exp
    const verifyTokenExp &#x3D; new Date(Date.now() + 1000 * 60 + 15);
    //upload image to queue
    const profilePicture &#x3D; await this.upload.uploadAndGetUrl(file);
    //check if user exists
    const isExist &#x3D; await this.isUserExists({ email: data.email });

    if (isExist) {
      return new BadRequestException(&#x27;User already exists&#x27;);
    }
    //hash verify token
    const hashedToken &#x3D; await Util.hash(verifyToken);
    //if not exists then create user
    const user &#x3D; await this.prisma.user.create({
      data: {
        ...data,
        profilePicture,
        verifyToken: hashedToken,
        verifyTokenExp,
      },
    });
    //if user created send account verification email
    if (user) {
      await this.mail.sendAccountVerifyEmail({
        to: user.email,
        userName: user.username,
        verificationLink: &#x60;${req.protocol}://${req.get(&#x27;host&#x27;)}/token&#x3D;${verifyToken}&amp;uid&#x3D;${user.id}&#x60;,
        year: new Date().getFullYear(),
      });
    }
    //return data
    return {
      success: true,
      message: &#x27;Register Successful!&#x27;,
    };
  }

  //validate account verify email and update status
  public async validateAccountVerifyEmail(data: AccountVerifyDto) {
    //find unique user
    const isUserExist &#x3D; await this.prisma.user.findUnique({
      where: {
        id: data.uid,
      },
      select: {
        id: true,
        verifyToken: true,
        verifyTokenExp: true,
      },
    });
    //check if user, user&#x27;s verify token, user&#x27;s verify token exp is available or not
    if (
      !isUserExist ||
      !isUserExist.verifyToken ||
      !isUserExist.verifyTokenExp
    ) {
      throw new NotFoundException(&#x27;User not exist&#x27;);
    }
    //check if matched or not
    const isMatched &#x3D; await this.isMatched(
      isUserExist.verifyToken,
      data.verifyToken,
    );
    if (!isMatched) {
      throw new BadRequestException(&#x27;Tokens are not matched&#x27;);
    }
    //check expired or not
    const isExpired &#x3D; this.isExpired(isUserExist.verifyTokenExp);
    if (isExpired) {
      throw new BadRequestException(&#x27;Token is expired&#x27;);
    }
    //update status
    await this.updateUser(
      {
        verifyToken: null,
        verifyTokenExp: null,
        emailVerified: true,
      },
      isUserExist.id,
    );
    return { success: true, message: &#x27;Account email verified&#x27; };
  }

  //get access token after expire via refresh token
  async refreshToken(data: RefreshTokenDto) {
    //find unique user
    const user &#x3D; await this.prisma.user.findUnique({
      where: {
        id: data.id,
        isDeleted: false,
        emailVerified: true,
      },
      select: {
        refreshToken: true,
        refreshTokenExp: true,
        email: true,
        id: true,
      },
    });
    //check if user, user&#x27;s refresh token, user&#x27;s refresh token exp is available or not
    if (!user || !user.refreshToken || !user.refreshTokenExp) {
      throw new NotFoundException(&#x27;User or refresh token not found&#x27;);
    }
    //is refresh tokens are matched
    const isMatched &#x3D; await this.isMatched(user.refreshToken, data.token);
    //is token is expired
    const isExpired &#x3D; this.isExpired(user.refreshTokenExp);
    //if expired or not matched throw error
    if (!isMatched || isExpired) {
      throw new BadRequestException(&#x27;Tokens are not matched or expired&#x27;);
    }
    //verify with jwt the token
    await this.jwt.verify(data.token, {
      secret: this.refreshTokenSecret,
    });
    //revoke new token and save in db
    const tokens &#x3D; await this.saveTokenInDb(user.id, user.email);
    return {
      success: true,
      message: &#x27;New tokens revoked!&#x27;,
      data: {
        accessToken: tokens.accessToken,
        refreshToken: tokens.refreshToken,
      },
    };
  }
  //resend verify email
  public async resendAccountVerification(email: string, req: Request) {
    //find unique
    const user &#x3D; await this.prisma.user.findUnique({
      where: {
        email: email,
        emailVerified: false,
        isDeleted: false,
      },
      select: {
        verifyToken: true,
        verifyTokenExp: true,
        id: true,
        email: true,
        username: true,
      },
    });
    //check if user, user&#x27;s verify token, user&#x27;s verify token exp is available or not

    if (!user || !user.verifyToken || !user.verifyTokenExp) {
      throw new NotFoundException(&#x27;User not found or already verified&#x27;);
    }
    //check if expired
    const isExpired &#x3D; this.isExpired(user.verifyTokenExp);
    if (!isExpired) {
      throw new BadRequestException(
        &#x27;Token is valid right now. no need to request new&#x27;,
      );
    }
    const verifyToken &#x3D; await Util.hash(Util.genToken());
    const verifyTokenExp &#x3D; new Date(Date.now() + 1000 * 60 * 15);
    //update the new token and send email
    await this.updateUser(
      {
        verifyToken,
        verifyTokenExp,
      },
      user.id,
    );
    await this.mail.sendAccountVerifyEmail({
      to: user.email,
      userName: user.username,
      verificationLink: &#x60;${req.protocol}://${req.get(&#x27;host&#x27;)}/token&#x3D;${verifyToken}/uid&#x3D;${user.id}&#x60;,
      year: new Date().getFullYear(),
    });
    return {
      success: true,
      message: &#x27;Verification email sent!&#x27;,
    };
  }

  //save refresh token in db
  private async saveTokenInDb(
    userId: string,
    email: string,
    provider?: &#x27;email&#x27; | &#x27;github&#x27; | &#x27;google&#x27;,
  ) {
    //generate tokens
    const tokens &#x3D; await this.generateTokens({
      email: email,
      sub: userId,
    });
    //hash refresh token
    const hashedToken &#x3D; await Util.hash(tokens.refreshToken);
    //save hashed refresh token in db
    await this.updateUser(
      {
        refreshToken: hashedToken,
        refreshTokenExp: new Date(Date.now() + 1000 * 60 * 60 * 24 * 7),
        ...(provider &amp;&amp; { provider: provider }),
      },
      userId,
    );
    return tokens;
  }

  //login a user
  public async loginUser(data: LoginDto) {
    const user &#x3D; await this.prisma.user.findUnique({
      where: {
        email: data.email,
        emailVerified: true,
        isDeleted: false,
      },
    });
    if (!user) {
      throw new NotFoundException(&#x27;User not found for this email!&#x27;);
    }
    //if login provider is email then check user has password or not
    if (user.provider &#x3D;&#x3D;&#x3D; &#x27;email&#x27;) {
      if (!user.password) {
        throw new BadRequestException(
          &#x27;Password not set for this user. use social login&#x27;,
        );
      }
      //check if password or not
      const isMatched &#x3D; await this.isMatched(user.password, data.password);

      if (!isMatched) {
        throw new BadRequestException(&#x27;Credentials are not matched&#x27;);
      }
    }
    //save and get tokens
    const tokens &#x3D; await this.saveTokenInDb(user.id, user.email, &#x27;email&#x27;);
    //return data
    return {
      success: true,
      message: &#x27;Logged in successfully!&#x27;,
      data: {
        accessToken: tokens.accessToken,
        refreshToken: tokens.refreshToken,
      },
    };
  }

  public async googleLogin(data: GoogleLoginDto) {
    //check if user exists
    let user &#x3D; await this.prisma.user.findUnique({
      where: {
        email: data.email,
      },
    });

    //if not create a user
    if (!user) {
      user &#x3D; await this.prisma.user.create({
        data: {
          ...data,
          provider: &#x27;google&#x27;,
        },
      });
    }
    //set and get tokens
    const tokens &#x3D; await this.saveTokenInDb(user.id, user.email, &#x27;email&#x27;);
    //return data
    return {
      success: true,
      message: &#x27;Google login successful&#x27;,
      data: {
        accessToken: tokens.accessToken,
        refreshToken: tokens.refreshToken,
      },
    };
  }

  //github login
  public async githubLogin(data: GithubLoginDto) {
    //find if user exists
    let user &#x3D; await this.prisma.user.findUnique({
      where: {
        email: data.email,
      },
    });

    //if not then create a user
    if (!user) {
      user &#x3D; await this.prisma.user.create({
        data: {
          ...data,
          provider: &#x27;github&#x27;,
        },
      });
    }
    //set and get tokens
    const tokens &#x3D; await this.saveTokenInDb(user.id, user.email, &#x27;email&#x27;);
    //send response to client
    return {
      success: true,
      message: &#x27;Github login successful&#x27;,
      data: {
        accessToken: tokens.accessToken,
        refreshToken: tokens.refreshToken,
      },
    };
  }

  //generate access &amp; refresh token
  private async generateTokens(data: IJwtPayload) {
    //generating both token using jwt
    const [accessToken, refreshToken] &#x3D; await Promise.all([
      //access token
      this.jwt.sign(data, {
        secret: this.accessTokenSecret,
        expiresIn: this.accessTokenExpiresIn,
      }),
      //refresh token
      this.jwt.sign(data, {
        secret: this.refreshTokenSecret,
        expiresIn: this.refreshTokenExpiresIn,
      }),
    ]);
    //return both
    return { accessToken, refreshToken };
  }

  //forget password
  public async forgetPassword(data: ForgetPasswordDto, req: Request) {
    //check is user available
    const user &#x3D; await this.prisma.user.findUnique({
      where: {
        email: data.email,
      },
      select: {
        id: true,
        email: true,
        name: true,
        resetToken: true,
        resetTokenExp: true,
      },
    });
    //check is user already has reset token as well as expired or not
    if (!user) {
      throw new NotFoundException(&#x27;User not found!&#x27;);
    }
    if (
      user.resetToken &amp;&amp;
      user.resetTokenExp &amp;&amp;
      !this.isExpired(user.resetTokenExp)
    ) {
      throw new BadRequestException(
        &#x27;A reset email was already sent. Please wait before requesting again.&#x27;,
      );
    }
    //added reset token to db
    const resetToken &#x3D; Util.genToken();
    const resetTokenExp &#x3D; new Date(Date.now() + 1000 * 60 * 15);
    const hashed &#x3D; await Util.hash(resetToken);
    await this.updateUser(
      {
        resetToken: hashed,
        resetTokenExp,
      },
      user.id,
    );
    //send forget password email
    await this.mail.passwordResetEmail({
      to: user.email,
      name: user.name,
      resetUrl: &#x60;${req.protocol}://${req.get(&#x27;host&#x27;)}/token&#x3D;${resetToken}/uid&#x3D;${user.id}&#x60;,
    });

    return { success: true, message: &#x27;Password reset email sent&#x27; };
  }

  //change password
  public async changePassword(data: ChangePasswordDto) {
    //find the user
    const user &#x3D; await this.prisma.user.findUnique({
      where: {
        id: data.uid,
        emailVerified: true,
        isDeleted: false,
        provider: &#x27;email&#x27;,
      },
    });
    if (!user) {
      throw new NotFoundException(&#x27;User not found!&#x27;);
    }
    //match old password
    if (!user.password) {
      throw new BadRequestException(&#x27;User has no password. Use social login&#x27;);
    }
    const isMatched &#x3D; await this.isMatched(user.password, data.oldPassword);
    if (!isMatched) {
      throw new BadRequestException(&#x27;Old password is not matched!&#x27;);
    }
    //hash new password
    const hashed &#x3D; await Util.hash(data.newPassword);
    //update password
    await this.updateUser(
      {
        password: hashed,
      },
      user.id,
    );
    return { success: true, message: &#x27;Password changed successfully&#x27; };
  }

  //reset password
  public async resetPassword(data: ResetPasswordDto) {
    //find unique user
    const user &#x3D; await this.prisma.user.findUnique({
      where: {
        id: data.uid,
        emailVerified: true,
        isDeleted: false,
      },
      select: {
        resetToken: true,
        resetTokenExp: true,
        id: true,
      },
    });
    //check if user, user&#x27;s reset token, user&#x27;s reset token exp is available or not

    if (!user || !user.resetToken || !user.resetTokenExp) {
      throw new UnauthorizedException(&#x27;User not found!&#x27;);
    }
    //check is matched with req data
    const isMatched &#x3D; await this.isMatched(user.resetToken, data.token);
    if (!isMatched)
      throw new UnauthorizedException(&#x27;Reset Token is not valid!&#x27;);
    //check is token expired
    const isExpired &#x3D; this.isExpired(user.resetTokenExp);
    if (!isExpired) throw new ForbiddenException(&#x27;Reset token is expired&#x27;);

    //hash the new password
    const hashed &#x3D; await Util.hash(data.newPassword);
    //update password
    await this.updateUser(
      {
        resetToken: null,
        resetTokenExp: null,
        password: hashed,
      },
      user.id,
    );
    return { success: true, message: &#x27;Password successfully reset&#x27; };
  }

  //update user route
  public async updateUser(data: Partial&lt;UpdateUserDto&gt;, id: string) {
    //check user exists or not
    const user &#x3D; await this.isUserExists({ id });
    //if not then throw an exception
    if (!user) {
      throw new NotFoundException(&#x27;User not found&#x27;);
    }
    //update the user
    const updatedUser &#x3D; await this.prisma.user.update({
      where: {
        id,
        isDeleted: false,
      },
      data: {
        ...data,
      },
    });
    //return data
    return {
      success: true,
      message: &#x27;User updated successfully!&#x27;,
      data: updatedUser,
    };
  }

  public async logOut(data: LogoutDto) {
    const user &#x3D; await this.isUserExists({ id: data.id });
    if (!user) {
      throw new NotFoundException(&#x27;User not found!&#x27;);
    }
    await this.updateUser(
      {
        refreshToken: null,
        refreshTokenExp: null,
        resetToken: null,
        resetTokenExp: null,
        verifyToken: null,
        verifyTokenExp: null,
      },
      data.id,
    );
  }
}
</code></pre>
    </div>

</div>













                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'AuthService.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
